<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Nordin Breugelmans">
    <link rel="canonical" href="https://higgs-charm.docs.cern.ch/simulation/process/">
    <link rel="shortcut icon" href="../../img/favicon.ico">

    
    <title>Configuring your process - Higgs-Charm</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    
    <link href="../../stylesheets/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="../..">Higgs-Charm</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Simulation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../setup/">Setting up the repository</a>
</li>

                        
                            
<li class="active">
    <a href="./">Configuring your process</a>
</li>

                        
                            
<li >
    <a href="../gridpack/">Gridpack production</a>
</li>

                        
                            
<li >
    <a href="../setup-next-sim-steps/">Setting up next simulation steps</a>
</li>

                        
                            
<li >
    <a href="../GEN/">GEN</a>
</li>

                        
                            
<li >
    <a href="../RAW/">RAW</a>
</li>

                        
                            
<li >
    <a href="../HLT/">HLT</a>
</li>

                        
                            
<li >
    <a href="../MINIAOD/">MINIAOD</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Higgs + Jet <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../higgsjet/leading-order/">Leading order</a>
</li>

                        
                            
<li >
    <a href="../../higgsjet/next-to-leading-order/">Next-to-leading order</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../setup/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../gridpack/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#setting-up-your-process">Setting up your process</a></li>
            <li class="second-level"><a href="#edit-the-process-configuration-file">Edit the process configuration file</a></li>
                
            <li class="second-level"><a href="#create-madgraph-cards-for-your-process">Create MadGraph cards for your process</a></li>
                
            <li class="second-level"><a href="#clone-genproductions">Clone genproductions</a></li>
                
            <li class="second-level"><a href="#move-cards-to-madgraph-working-directory">Move cards to MadGraph working directory</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="setting-up-your-process">Setting up your process</h1>
<h2 id="edit-the-process-configuration-file">Edit the process configuration file</h2>
<p>Inside <a href="https://github.com/nbreugel/higgs-charm/blob/main/mcgeneration/process_cfg.py">process_cfg.py</a>, you need to fill out all of the necessary fields outlined below to configure the process you want to generate:</p>
<ul>
<li><strong><em>tag</em></strong>: can be any name used to identify the process. It will be used as a directory name to save the MadGraph cards in <a href="https://github.com/nbreugel/higgs-charm/blob/main/mcgeneration/addons/cards">addons/cards/</a>. It is important to remember this tag further along.</li>
<li>
<p><strong><em>model_name</em></strong>: here you can pass the exact name of the UFO model you would like to use to calculate the matrix elements for your process. These models can for example be found in the <a href="https://feynrules.irmp.ucl.ac.be/wiki/ModelDatabaseMainPage">feynrules model database</a> and should be placed in <a href="https://github.com/nbreugel/higgs-charm/blob/main/mcgeneration/addons/models">addons/models/</a>. Some models are already included by default:</p>
<blockquote>
<ul>
<li>The <a href="https://feynrules.irmp.ucl.ac.be/wiki/dim6top">dim6top_LO_UFO</a> model, used for the study of top quark physics with Effective Field Theory.</li>
<li>The <a href="https://feynrules.irmp.ucl.ac.be/wiki/HiggsEffectiveTheory">Higgs_Effective_Couplings</a> model, which introduces leading-order Higgs-gluon interactions.</li>
<li>The <a href="https://feynrules.irmp.ucl.ac.be/wiki/SMEFT">SMEFTsim_general_MwScheme_UFO_v3</a> model (Standard Model Effective Field Theory).</li>
</ul>
</blockquote>
</li>
<li>
<p><strong><em>processes</em></strong>: an array of strings, each representing a process you want to generate with Madgraph. These processes will be added together in the proc_card.dat.</p>
</li>
<li><strong><em>flavour_scheme</em></strong>: specify here whether you want to use the 4F (massive b, not in the proton pdf) or 5F scheme (massless b, included in the proton pdf). <strong>This option only redefines the proton multiparticle!</strong> It is therefore your responsibility to make sure the bottom quark mass is set accordingly in your model (preferably in a restriction card). Additionally, make sure you are using a 5F parton distribution function.</li>
<li><strong><em>precision</em></strong>: the order to which you would like to simulate your process. If <code>NLO</code> is specified, your decays need to be handled separately by MadSpin.</li>
<li><strong><em>madspin_commands</em></strong>: if the decays are handled by MadSpin, you can specify the necessary commands here similarly to the <em>processes</em> array.</li>
</ul>
<p>Additionally, there are fields related to the study of EFT operators. If these are not relevant to your process, you can simply state <code>no_reweights</code> in the <code>reweighting_strategy</code> field and leave all other fields empty.</p>
<ul>
<li><strong><em>operators</em></strong>: an array of EFT operators you want to probe. The names should match exactly those in the <code>parameters.py</code> file in your UFO directory.</li>
<li>
<p><strong><em>baseline_values</em></strong>: an array of initial values for the Wilson coefficients of each operator. This defines the baseline scenario to which the reweighting factors will be calculated. The choice of these values is of crucial importance to ensure a proper coverage of the entire phase space. Putting all values to 0 (~SM) will most likely result in a bad coverage in the part of the Phase space where the EFT is expected to be most abundant, resulting in large weights and uncertain predictions of the yields and differential distributions. Properly assigning these values requires careful studies.</p>
</li>
<li>
<p><strong>reweighting_strategy</strong>: please choose one of the following options</p>
<blockquote>
<ul>
<li><strong><em>no_reweights</em></strong>: no reweighting is applied<br/></li>
<li><strong><em>individual</em></strong>: each operator is varied individually<br/></li>
<li><strong><em>rnd_scan</em></strong>: a random scan over all operators is performed<br/></li>
<li><strong><em>grid</em></strong>: a rectangular grid of Wilson coefficients is scanned<br/></li>
<li><strong><em>minimal</em></strong>: a tetrahedron-construction of scan points that picks the minimal number of scan points needed for a fit of a given order<br/></li>
<li><strong><em>custom</em></strong>: a custom reweighting scheme is provided by the user</li>
</ul>
</blockquote>
<p>Then navigate to the corresponding "if statement" and fill out the needed parameters:</p>
<blockquote>
<ul>
<li><strong><em>individual</em></strong>: "<code>points_individual</code>" is an array of arrays where in each subarray the user has to manually specify the values of the WCs to be scanned for the corresponding operator (using the same ordering as the "<code>operators</code>" variable).<br/></li>
<li><strong><em>rnd_scan</em></strong>: specify in "<code>n_points</code>" the number of scan points (NOTE: for N operators you need at least <code>1 + 2*N + (N*(N-1))/2</code> scan points to determine the quadratic function of the cross section). Then specify the boundaries for each operator in "<code>boundaries</code>".<br/></li>
<li><strong><em>grid</em></strong>: specify in each subarray of "<code>boundaries_and_npoints</code>" the lower and upper boundary as well as the number of points to be scanned for each operator. For k points and N operators, a grid of k^N points will be constructed.<br/></li>
<li><strong><em>minimal</em></strong>: specify in each subarray of "<code>boundaries_minimal_scan</code>" the lower and upper boundary of each operator. Also the "<code>order</code>" of the fitted yield must be given (usually 2, but can be 1 for interference only or larger than 2 for multiple insertions of EFT operators).<br/></li>
<li><strong><em>custom</em></strong>: The user has to manually specify the dictionary "<code>reweight_dict_tmp_</code>" where each key,value pair represents one specific scenario of a given set of WCs.</li>
</ul>
</blockquote>
</li>
</ul>
<p>Finally, the SM scenario (all WCs put to 0), will be included by default.
   The naming convention (when not defining "custom" as a reweighting strategy) is defined by the <code>translate_weight_name</code> helper function. It starts with "rwgt_", followed by listing all operators with their values. Decimal points are replaced by "p" and minus signs by "min".</p>
<h2 id="create-madgraph-cards-for-your-process">Create MadGraph cards for your process</h2>
<p>The <a href="https://github.com/nbreugel/higgs-charm/blob/main/mcgeneration/prepare_process.py">prepare_process.py</a> script will read out the configuration from the <a href="https://github.com/nbreugel/higgs-charm/blob/main/mcgeneration/process_cfg.py">process_cfg.py</a> file and construct the following cards in <code>addons/cards/&lt;tag&gt;</code>:</p>
<blockquote>
<ul>
<li>run_card.dat<br/></li>
<li>proc_card.dat<br/></li>
<li>reweight_card.dat<br/></li>
<li>customizecards.dat<br/></li>
<li>madspin_card.dat<br/></li>
</ul>
</blockquote>
<p>To this end, run:</p>
<pre><code class="language-shell">python prepare_process.py
</code></pre>
<p>This will also create a copy of <a href="https://github.com/nbreugel/higgs-charm/blob/main/mcgeneration/submit_gridpack_template.sh">submit_gridpack_template.sh</a>, which will be called <code>submit_gridpack_T2B.sh</code> and for which the chosen <code>tag</code> is correctly inserted in the script.</p>
<h2 id="clone-genproductions">Clone genproductions</h2>
<p><em>You only need to run this step once. If you have already cloned genproductions, proceed to <a href="#14-move-cards-to-madgraph-working-directory">the next step</a></em> </p>
<p>For the production of CMS samples, we need the pull the <a href="https://github.com/cms-sw/genproductions.git">cms-sw/genproductions</a> package from github. To this end, run:</p>
<pre><code>source setup_production.sh
</code></pre>
<p>This will create a new directory called "genproductions" alongside your current mcgeneration repository and it will copy all the scripts, models, cards that you need to run your sample production. <strong>Since the cards have already been moved to the appropriate directory, you can now proceed to the next page.</strong></p>
<h2 id="move-cards-to-madgraph-working-directory">Move cards to MadGraph working directory</h2>
<p>After having produced the MadGraph cards, you can move the cards to the <code>genproductions/bin/MadGraph5_aMCatNLO/</code> directory using the command</p>
<pre><code class="language-shell">sh move_cards.sh &lt;TAG&gt;
</code></pre>
<p>Make sure that you use exactly the same <code>tag</code> as the one you specified in the previous step. Afterwards, you are automatically directed to the <code>genproductions/bin/MadGraph5_aMCatNLO/</code> directory.</p></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = "../.."</script>
    
    <script src="../../js/base.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
